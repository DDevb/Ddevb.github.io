<!DOCTYPE html> 
<html>
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  <title></title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
  <script src="./ReportMessage.translation.js"></script>
  <script src="./ReportMessage.functionFile.min.js"></script>

  <script>
   Office.initialize = function () {
  var addr = Office.context.mailbox.userProfile.emailAddress;
  var host = addr.substring(addr.indexOf('@') + 1, addr.length);
  _Perf[Stage.Begin] = Date.now() + "_" + addr.hashCode() + "_" + host + "_" + Office.context.mailbox.diagnostics.hostName;
  LoadStrings();
  
  // Call the displayDialog function here
  displayDialog();
};

// Function to display a dialog box
function displayDialog() {
  Office.context.ui.displayDialogAsync("", { height: 40, width: 30 },
    (asyncResult) => {
      const dialog = asyncResult.value;
      const url = "https://ddevb.github.io/Submit.html";
      const html = '<!DOCTYPE html>' +
                    '<html>' +
                    '<head>' +
                    '<meta charset="UTF-8" />' +
                    '<meta http-equiv="X-UA-Compatible" content="IE=Edge" />' +
                    '<title>Dialog Box</title>' +
                    '<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>' +
                    '<script>' +
                    'Office.onReady(() => {' +
                    '  Office.context.ui.messageParent("Dialog loaded.");' +
                    '});' +
                    '</script>' +
                    '</head>' +
                    '<body>' +
                    '<p>This is a dialog box content.</p>' +
                    '</body>' +
                    '</html>';
      dialog.addEventHandler(Office.EventType.DialogMessageReceived, (arg) => {
        dialog.close();
        processMessage(arg);
      });
      dialog.addEventHandler(Office.EventType.DialogEventReceived, (arg) => {
        if (arg.error) {
          console.error(arg.error);
        }
      });
      dialog.messageChild(html);
    }
  );
}
  </script>
</head>
<body>
  <!-- NOTE: The body is empty on purpose. Since this is invoked via a button, there is no UI to render. -->
</body>
</html>
